---
title: "Final Project"
output: pdf_document
date: "2023-07-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(dplyr)
library(ggplot2)
library(ggpubr)
gene_expression <- read.csv(file = "QBS103_finalProject_geneExpression.csv")
meta_data <- read.csv(file = "QBS103_finalProject_metadata.csv")
# Transpose the dataset in order to link the 2 sets of data
gene_transposed <- data.frame(cbind(names(gene_expression), t(gene_expression)))
rownames(gene_transposed) <- NULL
colnames(gene_transposed) <- gene_transposed[1,]
# delete the first redundant row to match the entries
gene_final <- gene_transposed[-1,]
# Create a data frame with the participant ID, gene number 5 (PRTN3), one continuous covariate (age) and 
# two categorical covariants (sex and ICU status)
linked_data <- data.frame("Participant_ID" = meta_data$participant_id,
                          "Age" = meta_data$age,
                          "Sex" = meta_data$sex,
                          "ICU_Status" = meta_data$icu_status,
                          "BPI_Gene" = as.numeric(gene_final$BPI))
linked_data
# Histogram for gene expression
ggplot(linked_data, aes(x = BPI_Gene)) +
  geom_histogram(binwidth = 10, ,fill = "red", color = "black") +
  labs(title = "Histogram for Gene Expression", x = "BPI Gene Expression", y = "Frequency")
# Scatter plot
ggplot(linked_data, aes(x = Age, y = BPI_Gene)) +
  geom_point(color = "red") +
  labs(title = "Scatterplot for Gene Expression and Continuous Covariat", y = "BPI Gene Expression")
# Box plot
icuplot <- ggplot(linked_data, aes(x = ICU_Status, y = BPI_Gene, color = Sex)) +
  geom_boxplot() +
  labs(title = "Gene Separated by ICU Status", x = "ICU Status", y = "BPI Gene Expression")
sexplot <- ggplot(linked_data, aes(x = Sex, y = BPI_Gene, color = ICU_Status)) +
  geom_boxplot() +
  labs(title = "Gene Separated by Biological Sex", y = "BPI Gene Expression")
icuplot
sexplot
ggarrange(icuplot, sexplot, labels = c("A", "B"))
```
